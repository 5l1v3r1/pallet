<html lang="en">
  <head>
    <title>pallet.monad documentation</title>
    <link href="css/default.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/page_effects.js"></script>
  </head>
  <body>
    <header>
      <div id="header">
        <h1 class="project-title">Pallet 0.8 API documentation</h1>
      </div>
    </header>
    <navigation>
      <div id="namespaces" class="sidebar">
        <h3>Namespaces</h3>
        <ul class="ns-links">
          <li class="ns-link"><a href="pallet.action.html">pallet.action</a></li><li class="ns-link"><a href="pallet.action-impl.html">pallet.action-impl</a></li><li class="ns-link"><a href="pallet.action-plan.html">pallet.action-plan</a></li><li class="ns-link"><a href="pallet.actions.html">pallet.actions</a></li><li class="ns-link"><a href="pallet.actions.direct.html">pallet.actions.direct</a></li><li class="ns-link"><a href="pallet.actions.direct.conditional.html">pallet.actions.direct.conditional</a></li><li class="ns-link"><a href="pallet.actions.direct.directory.html">pallet.actions.direct.directory</a></li><li class="ns-link"><a href="pallet.actions.direct.exec-script.html">pallet.actions.direct.exec-script</a></li><li class="ns-link"><a href="pallet.actions.direct.file.html">pallet.actions.direct.file</a></li><li class="ns-link"><a href="pallet.actions.direct.package.html">pallet.actions.direct.package</a></li><li class="ns-link"><a href="pallet.actions.direct.remote-directory.html">pallet.actions.direct.remote-directory</a></li><li class="ns-link"><a href="pallet.actions.direct.remote-file.html">pallet.actions.direct.remote-file</a></li><li class="ns-link"><a href="pallet.actions.direct.retry.html">pallet.actions.direct.retry</a></li><li class="ns-link"><a href="pallet.actions.direct.rsync.html">pallet.actions.direct.rsync</a></li><li class="ns-link"><a href="pallet.actions.direct.service.html">pallet.actions.direct.service</a></li><li class="ns-link"><a href="pallet.actions.direct.settings.html">pallet.actions.direct.settings</a></li><li class="ns-link"><a href="pallet.actions.direct.user.html">pallet.actions.direct.user</a></li><li class="ns-link"><a href="pallet.actions-impl.html">pallet.actions-impl</a></li><li class="ns-link"><a href="pallet.api.html">pallet.api</a></li><li class="ns-link"><a href="pallet.argument.html">pallet.argument</a></li><li class="ns-link"><a href="pallet.blobstore.html">pallet.blobstore</a></li><li class="ns-link"><a href="pallet.blobstore.implementation.html">pallet.blobstore.implementation</a></li><li class="ns-link"><a href="pallet.blobstore.url-blobstore.html">pallet.blobstore.url-blobstore</a></li><li class="ns-link"><a href="pallet.cache.html">pallet.cache</a></li><li class="ns-link"><a href="pallet.cache.impl.html">pallet.cache.impl</a></li><li class="ns-link"><a href="pallet.command-line.html">pallet.command-line</a></li><li class="ns-link"><a href="pallet.command-script.html">pallet.command-script</a></li><li class="ns-link"><a href="pallet.compute.hybrid.html">pallet.compute.hybrid</a></li><li class="ns-link"><a href="pallet.compute.implementation.html">pallet.compute.implementation</a></li><li class="ns-link"><a href="pallet.compute.jvm.html">pallet.compute.jvm</a></li><li class="ns-link"><a href="pallet.compute.node-list.html">pallet.compute.node-list</a></li><li class="ns-link"><a href="pallet.config-file.format.html">pallet.config-file.format</a></li><li class="ns-link"><a href="pallet.configure.html">pallet.configure</a></li><li class="ns-link"><a href="pallet.context.html">pallet.context</a></li><li class="ns-link"><a href="pallet.core.html">pallet.core</a></li><li class="ns-link"><a href="pallet.core.api.html">pallet.core.api</a></li><li class="ns-link"><a href="pallet.core.api-impl.html">pallet.core.api-impl</a></li><li class="ns-link"><a href="pallet.core.operations.html">pallet.core.operations</a></li><li class="ns-link"><a href="pallet.core.plan-state.html">pallet.core.plan-state</a></li><li class="ns-link"><a href="pallet.core.primitives.html">pallet.core.primitives</a></li><li class="ns-link"><a href="pallet.core.session.html">pallet.core.session</a></li><li class="ns-link"><a href="pallet.core.user.html">pallet.core.user</a></li><li class="ns-link"><a href="pallet.crate.html">pallet.crate</a></li><li class="ns-link"><a href="pallet.crate.automated-admin-user.html">pallet.crate.automated-admin-user</a></li><li class="ns-link"><a href="pallet.crate.crontab.html">pallet.crate.crontab</a></li><li class="ns-link"><a href="pallet.crate.environment.html">pallet.crate.environment</a></li><li class="ns-link"><a href="pallet.crate.etc-default.html">pallet.crate.etc-default</a></li><li class="ns-link"><a href="pallet.crate.etc-hosts.html">pallet.crate.etc-hosts</a></li><li class="ns-link"><a href="pallet.crate.filesystem.html">pallet.crate.filesystem</a></li><li class="ns-link"><a href="pallet.crate.network-service.html">pallet.crate.network-service</a></li><li class="ns-link"><a href="pallet.crate.package.centos.html">pallet.crate.package.centos</a></li><li class="ns-link"><a href="pallet.crate.package.debian-backports.html">pallet.crate.package.debian-backports</a></li><li class="ns-link"><a href="pallet.crate.package.epel.html">pallet.crate.package.epel</a></li><li class="ns-link"><a href="pallet.crate.package.jpackage.html">pallet.crate.package.jpackage</a></li><li class="ns-link"><a href="pallet.crate.package.rpmforge.html">pallet.crate.package.rpmforge</a></li><li class="ns-link"><a href="pallet.crate.package-repo.html">pallet.crate.package-repo</a></li><li class="ns-link"><a href="pallet.crate.ssh-key.html">pallet.crate.ssh-key</a></li><li class="ns-link"><a href="pallet.crate.sudoers.html">pallet.crate.sudoers</a></li><li class="ns-link"><a href="pallet.crate-install.html">pallet.crate-install</a></li><li class="ns-link"><a href="pallet.debug.html">pallet.debug</a></li><li class="ns-link"><a href="pallet.echo.execute.html">pallet.echo.execute</a></li><li class="ns-link"><a href="pallet.enlive.html">pallet.enlive</a></li><li class="ns-link"><a href="pallet.environment.html">pallet.environment</a></li><li class="ns-link"><a href="pallet.event.html">pallet.event</a></li><li class="ns-link"><a href="pallet.execute.html">pallet.execute</a></li><li class="ns-link"><a href="pallet.executors.html">pallet.executors</a></li><li class="ns-link"><a href="pallet.feature.html">pallet.feature</a></li><li class="ns-link"><a href="pallet.futures.html">pallet.futures</a></li><li class="ns-link"><a href="pallet.local.execute.html">pallet.local.execute</a></li><li class="ns-link"><a href="pallet.main.html">pallet.main</a></li><li class="ns-link"><a href="pallet.main-invoker.html">pallet.main-invoker</a></li><li class="ns-link"><a href="pallet.md5crypt.html">pallet.md5crypt</a></li><li class="ns-link"><a href="pallet.monad.html">pallet.monad</a></li><li class="ns-link"><a href="pallet.monad.state-accessors.html">pallet.monad.state-accessors</a></li><li class="ns-link"><a href="pallet.monad.state-monad.html">pallet.monad.state-monad</a></li><li class="ns-link"><a href="pallet.node-value.html">pallet.node-value</a></li><li class="ns-link"><a href="pallet.phase.html">pallet.phase</a></li><li class="ns-link"><a href="pallet.plugin.html">pallet.plugin</a></li><li class="ns-link"><a href="pallet.repl.html">pallet.repl</a></li><li class="ns-link"><a href="pallet.script.lib.html">pallet.script.lib</a></li><li class="ns-link"><a href="pallet.script-builder.html">pallet.script-builder</a></li><li class="ns-link"><a href="pallet.script-exec.html">pallet.script-exec</a></li><li class="ns-link"><a href="pallet.session.action-plan.html">pallet.session.action-plan</a></li><li class="ns-link"><a href="pallet.session.verify.html">pallet.session.verify</a></li><li class="ns-link"><a href="pallet.ssh.execute.html">pallet.ssh.execute</a></li><li class="ns-link"><a href="pallet.strint.html">pallet.strint</a></li><li class="ns-link"><a href="pallet.task.add-service.html">pallet.task.add-service</a></li><li class="ns-link"><a href="pallet.task.config.html">pallet.task.config</a></li><li class="ns-link"><a href="pallet.task.containers.html">pallet.task.containers</a></li><li class="ns-link"><a href="pallet.task.converge.html">pallet.task.converge</a></li><li class="ns-link"><a href="pallet.task.converge-cluster.html">pallet.task.converge-cluster</a></li><li class="ns-link"><a href="pallet.task.describe-node.html">pallet.task.describe-node</a></li><li class="ns-link"><a href="pallet.task.destroy-cluster.html">pallet.task.destroy-cluster</a></li><li class="ns-link"><a href="pallet.task.help.html">pallet.task.help</a></li><li class="ns-link"><a href="pallet.task.images.html">pallet.task.images</a></li><li class="ns-link"><a href="pallet.task.lift.html">pallet.task.lift</a></li><li class="ns-link"><a href="pallet.task.new-project.html">pallet.task.new-project</a></li><li class="ns-link"><a href="pallet.task.nodes.html">pallet.task.nodes</a></li><li class="ns-link"><a href="pallet.task.providers.html">pallet.task.providers</a></li><li class="ns-link"><a href="pallet.task.to-blob.html">pallet.task.to-blob</a></li><li class="ns-link"><a href="pallet.task.version.html">pallet.task.version</a></li><li class="ns-link"><a href="pallet.template.html">pallet.template</a></li><li class="ns-link"><a href="pallet.template.properties.html">pallet.template.properties</a></li><li class="ns-link"><a href="pallet.utils.html">pallet.utils</a></li><li class="ns-link"><a href="pallet.version-dispatch.html">pallet.version-dispatch</a></li><li class="ns-link"><a href="pallet.versions.html">pallet.versions</a></li>
        </ul>
      </div>
      <div id="vars" class="sidebar">
        <h3>Public Vars</h3>
        <ul class="ns-var-links">
          <li class="ns-var-link"><a href="pallet.monad.html#var-as-session-pipeline-fn">as-session-pipeline-fn</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-chain-s">chain-s</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-component-symbol-fn">component-symbol-fn</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-exec-s">exec-s</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-let-s">let-s</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-let-session">let-session</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-let-state">let-state</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-local-env">local-env</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-phase-pipeline">phase-pipeline</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-phase-pipeline-no-context">phase-pipeline-no-context</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-replace-in-top-level-forms">replace-in-top-level-forms</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-session-pipeline">session-pipeline</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-wrap-action-args">wrap-action-args</a></li><li class="ns-var-link"><a href="pallet.monad.html#var-wrap-pipeline">wrap-pipeline</a></li>
        </ul>
      </div>
    </navigation>
    <article>
      <div id="content" class="namespace-docs">
        <h2 class="namespace-title">pallet.monad documentation</h2>
        <div class="doc"><h1>Pallet monads</h1>

<p>Pallet uses monads for both internal core code, and for action and phase code
used in crates. The two uses are both fundamentally an application of the state
monad, but are each use a different context.</p>
</div>
        <div class="ns-vars">
          <div class="public">
            <h3 id="var-as-session-pipeline-fn">as-session-pipeline-fn</h3>
            <div class="usage">[f]</div>
            
            
            <div class="doc"><p>Converts a function of session -&gt; session and makes it a monadic value under
the state monad</p>
</div>
          </div><div class="public">
            <h3 id="var-chain-s">chain-s</h3>
            <div class="usage">[&amp; args]</div>
            
            
            <div class="doc"><p>Defines a monadic comprehension under the session monad, where return value
bindings not specified. Any vector in the arguments is expected to be of the
form [symbol expr] and becomes part of the generated monad comprehension.</p>
</div>
          </div><div class="public">
            <h3 id="var-component-symbol-fn">component-symbol-fn</h3>
            <div class="usage">[k]</div>
            
            
            <div class="doc"><p>Returns an inline function definition for a component look-up by symbol</p>
</div>
          </div><div class="public">
            <h3 id="var-exec-s">exec-s</h3>
            <div class="usage">[pipeline session]</div>
            
            
            <div class="doc"><p>Call a session-m state monad function, returning only the session map.</p>
</div>
          </div><div class="public">
            <h3 id="var-let-s">let-s</h3>
            <div class="usage">[&amp; body]</div>
            
            
            <div class="doc"><p>A monadic comprehension using the session-m monad. Provides some translation
of functions used (see <code>top-level-replacements</code>), and adds lookup of
components.</p>
</div>
          </div><div class="public">
            <h3 id="var-let-session">let-session</h3>
            <div class="usage">[comprehension-name event &amp; args]</div>
            
            
            <div class="doc"><p>Defines a session comprehension.</p>
</div>
          </div><div class="public">
            <h3 id="var-let-state">let-state</h3>
            <div class="usage">[&amp; body]</div>
            
            
            <div class="doc"><p>A monadic comprehension using the state-m monad. Adds lookup of components.</p>
</div>
          </div><div class="public">
            <h3 id="var-local-env">local-env</h3>
            <div class="usage">[]</div>
            
            
            <div class="doc"><p>Return the local environment as a map of keyword value pairs.</p>
</div>
          </div><div class="public">
            <h3 id="var-phase-pipeline">phase-pipeline</h3>
            <div class="usage">[pipeline-name event &amp; args]</div>
            
            
            <div class="doc"><p>Defines a session pipeline. This composes the body functions under the
session-m monad. Any vector in the arguments is expected to be of the form
[symbol expr] and becomes part of the generated monad comprehension.</p>

<p>The resulting function is wrapped in a named anonymous function to improve
stack traces.</p>

<p>A context is automatically added.</p>
</div>
          </div><div class="public">
            <h3 id="var-phase-pipeline-no-context">phase-pipeline-no-context</h3>
            <div class="usage">[pipeline-name event &amp; args]</div>
            
            
            <div class="doc"><p>Similar to <code>phase-pipeline</code>, but without the context.</p>
</div>
          </div><div class="public">
            <h3 id="var-replace-in-top-level-forms">replace-in-top-level-forms</h3>
            <div class="usage">[forms]</div>
            
            
            <div class="doc"><p>Replace some top level function names with their monadic equivalents.</p>
</div>
          </div><div class="public">
            <h3 id="var-session-pipeline">session-pipeline</h3>
            <div class="usage">[pipeline-name event &amp; args]</div>
            
            
            <div class="doc"><p>Defines a session pipeline. This composes the body functions under the
session-m monad. Any vector in the arguments is expected to be of the form
[symbol expr] and becomes part of the generated monad comprehension.</p>
</div>
          </div><div class="public">
            <h3 id="var-wrap-action-args">wrap-action-args</h3>
            <div class="usage">[forms]</div>
            
            
            <div class="doc"><p>Replace arguments to actions.</p>
</div>
          </div><div class="public">
            <h3 id="var-wrap-pipeline">wrap-pipeline</h3>
            <div class="usage">[sym &amp; wrappers-and-pipeline]</div>
            
            
            <div class="doc"><p>Wraps a pipeline with one or more wrapping forms. Makes the &amp;session symbol
available withing the bindings.</p>
</div>
          </div>
        </div>
      </div>
    </article>
  </body>

</html>