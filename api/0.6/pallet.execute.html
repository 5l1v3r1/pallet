<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>pallet.execute documentation</title></head><body><div id="header"><h1><a href="index.html">Pallet 0.6 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3>Namespaces</h3><ul><li><a href="pallet.action.html">pallet.action</a></li><li><a href="pallet.action.conditional.html">pallet.action.conditional</a></li><li><a href="pallet.action.directory.html">pallet.action.directory</a></li><li><a href="pallet.action.environment.html">pallet.action.environment</a></li><li><a href="pallet.action.exec-script.html">pallet.action.exec-script</a></li><li><a href="pallet.action.file.html">pallet.action.file</a></li><li><a href="pallet.action.filesystem.html">pallet.action.filesystem</a></li><li><a href="pallet.action.package.html">pallet.action.package</a></li><li><a href="pallet.action.package.centos.html">pallet.action.package.centos</a></li><li><a href="pallet.action.package.debian-backports.html">pallet.action.package.debian-backports</a></li><li><a href="pallet.action.package.epel.html">pallet.action.package.epel</a></li><li><a href="pallet.action.package.jpackage.html">pallet.action.package.jpackage</a></li><li><a href="pallet.action.package.rpmforge.html">pallet.action.package.rpmforge</a></li><li><a href="pallet.action.remote-directory.html">pallet.action.remote-directory</a></li><li><a href="pallet.action.remote-file.html">pallet.action.remote-file</a></li><li><a href="pallet.action.retry.html">pallet.action.retry</a></li><li><a href="pallet.action.rsync.html">pallet.action.rsync</a></li><li><a href="pallet.action.service.html">pallet.action.service</a></li><li><a href="pallet.action.user.html">pallet.action.user</a></li><li><a href="pallet.action-plan.html">pallet.action-plan</a></li><li><a href="pallet.argument.html">pallet.argument</a></li><li><a href="pallet.blobstore.html">pallet.blobstore</a></li><li><a href="pallet.blobstore.implementation.html">pallet.blobstore.implementation</a></li><li><a href="pallet.blobstore.jclouds.html">pallet.blobstore.jclouds</a></li><li><a href="pallet.blobstore.url-blobstore.html">pallet.blobstore.url-blobstore</a></li><li><a href="pallet.command-line.html">pallet.command-line</a></li><li><a href="pallet.command-script.html">pallet.command-script</a></li><li><a href="pallet.compute.html">pallet.compute</a></li><li><a href="pallet.compute.hybrid.html">pallet.compute.hybrid</a></li><li><a href="pallet.compute.implementation.html">pallet.compute.implementation</a></li><li><a href="pallet.compute.jclouds.html">pallet.compute.jclouds</a></li><li><a href="pallet.compute.jvm.html">pallet.compute.jvm</a></li><li><a href="pallet.compute.node-list.html">pallet.compute.node-list</a></li><li><a href="pallet.compute.vmfest.html">pallet.compute.vmfest</a></li><li><a href="pallet.config-file.format.html">pallet.config-file.format</a></li><li><a href="pallet.configure.html">pallet.configure</a></li><li><a href="pallet.core.html">pallet.core</a></li><li><a href="pallet.crate.network-service.html">pallet.crate.network-service</a></li><li><a href="pallet.debug.html">pallet.debug</a></li><li><a href="pallet.enlive.html">pallet.enlive</a></li><li><a href="pallet.environment.html">pallet.environment</a></li><li class="current"><a href="pallet.execute.html">pallet.execute</a></li><li><a href="pallet.futures.html">pallet.futures</a></li><li><a href="pallet.main.html">pallet.main</a></li><li><a href="pallet.main-invoker.html">pallet.main-invoker</a></li><li><a href="pallet.map-merge.html">pallet.map-merge</a></li><li><a href="pallet.maven.html">pallet.maven</a></li><li><a href="pallet.md5crypt.html">pallet.md5crypt</a></li><li><a href="pallet.node.html">pallet.node</a></li><li><a href="pallet.parameter.html">pallet.parameter</a></li><li><a href="pallet.phase.html">pallet.phase</a></li><li><a href="pallet.repl.html">pallet.repl</a></li><li><a href="pallet.request-map.html">pallet.request-map</a></li><li><a href="pallet.resource.html">pallet.resource</a></li><li><a href="pallet.resource.directory.html">pallet.resource.directory</a></li><li><a href="pallet.resource.exec-script.html">pallet.resource.exec-script</a></li><li><a href="pallet.resource.file.html">pallet.resource.file</a></li><li><a href="pallet.resource.filesystem.html">pallet.resource.filesystem</a></li><li><a href="pallet.resource.filesystem-layout.html">pallet.resource.filesystem-layout</a></li><li><a href="pallet.resource.format.html">pallet.resource.format</a></li><li><a href="pallet.resource.hostinfo.html">pallet.resource.hostinfo</a></li><li><a href="pallet.resource.lib.html">pallet.resource.lib</a></li><li><a href="pallet.resource.network-service.html">pallet.resource.network-service</a></li><li><a href="pallet.resource.package.html">pallet.resource.package</a></li><li><a href="pallet.resource.remote-directory.html">pallet.resource.remote-directory</a></li><li><a href="pallet.resource.remote-file.html">pallet.resource.remote-file</a></li><li><a href="pallet.resource.resource-when.html">pallet.resource.resource-when</a></li><li><a href="pallet.resource.rsync.html">pallet.resource.rsync</a></li><li><a href="pallet.resource.service.html">pallet.resource.service</a></li><li><a href="pallet.resource.shell.html">pallet.resource.shell</a></li><li><a href="pallet.resource.user.html">pallet.resource.user</a></li><li><a href="pallet.script.lib.html">pallet.script.lib</a></li><li><a href="pallet.session.html">pallet.session</a></li><li><a href="pallet.shell.html">pallet.shell</a></li><li><a href="pallet.strint.html">pallet.strint</a></li><li><a href="pallet.target.html">pallet.target</a></li><li><a href="pallet.task.add-service.html">pallet.task.add-service</a></li><li><a href="pallet.task.containers.html">pallet.task.containers</a></li><li><a href="pallet.task.converge.html">pallet.task.converge</a></li><li><a href="pallet.task.converge-cluster.html">pallet.task.converge-cluster</a></li><li><a href="pallet.task.describe-node.html">pallet.task.describe-node</a></li><li><a href="pallet.task.destroy-cluster.html">pallet.task.destroy-cluster</a></li><li><a href="pallet.task.help.html">pallet.task.help</a></li><li><a href="pallet.task.images.html">pallet.task.images</a></li><li><a href="pallet.task.lift.html">pallet.task.lift</a></li><li><a href="pallet.task.new-project.html">pallet.task.new-project</a></li><li><a href="pallet.task.nodes.html">pallet.task.nodes</a></li><li><a href="pallet.task.providers.html">pallet.task.providers</a></li><li><a href="pallet.task.to-blob.html">pallet.task.to-blob</a></li><li><a href="pallet.task.version.html">pallet.task.version</a></li><li><a href="pallet.task.vmfest-script.html">pallet.task.vmfest-script</a></li><li><a href="pallet.template.html">pallet.template</a></li><li><a href="pallet.template.properties.html">pallet.template.properties</a></li><li><a href="pallet.utils.html">pallet.utils</a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="pallet.execute.html#var-bash-on-origin">bash-on-origin</a></li><li><a href="pallet.execute.html#var-clojure-on-origin">clojure-on-origin</a></li><li><a href="pallet.execute.html#var-echo-bash">echo-bash</a></li><li><a href="pallet.execute.html#var-echo-clojure">echo-clojure</a></li><li><a href="pallet.execute.html#var-echo-transfer">echo-transfer</a></li><li><a href="pallet.execute.html#var-execute-echo">execute-echo</a></li><li><a href="pallet.execute.html#var-execute-target-on-localhost">execute-target-on-localhost</a></li><li><a href="pallet.execute.html#var-execute-with-ssh">execute-with-ssh</a></li><li><a href="pallet.execute.html#var-local-checked-script">local-checked-script</a></li><li><a href="pallet.execute.html#var-local-cmds">local-cmds</a></li><li><a href="pallet.execute.html#var-local-script">local-script</a></li><li><a href="pallet.execute.html#var-local-script-expand">local-script-expand</a></li><li><a href="pallet.execute.html#var-output-poll-period">output-poll-period</a></li><li><a href="pallet.execute.html#var-remote-exec">remote-exec</a></li><li><a href="pallet.execute.html#var-remote-sudo">remote-sudo</a></li><li><a href="pallet.execute.html#var-remote-sudo-cmd">remote-sudo-cmd</a></li><li><a href="pallet.execute.html#var-sh-script">sh-script</a></li><li><a href="pallet.execute.html#var-ssh-bash-on-target">ssh-bash-on-target</a></li><li><a href="pallet.execute.html#var-ssh-from-local">ssh-from-local</a></li><li><a href="pallet.execute.html#var-ssh-output-buffer-size">ssh-output-buffer-size</a></li><li><a href="pallet.execute.html#var-ssh-to-local">ssh-to-local</a></li><li><a href="pallet.execute.html#var-ssh-user-credentials">ssh-user-credentials</a></li><li><a href="pallet.execute.html#var-sudo-cmd-for">sudo-cmd-for</a></li><li><a href="pallet.execute.html#var-transfer-on-origin">transfer-on-origin</a></li><li><a href="pallet.execute.html#var-verify-sh-return">verify-sh-return</a></li><li><a href="pallet.execute.html#var-with-ssh-tunnel">with-ssh-tunnel</a></li></ul></div><div class="namespace-docs" id="content"><h2>pallet.execute documentation</h2><pre class="doc">Exectute commands.  At the moment the only available transport is ssh.
</pre><div class="public" id="var-bash-on-origin"><h3>bash-on-origin</h3><div class="usage"><code>(bash-on-origin session f)</code></div><pre class="doc">Execute a bash action on the origin
</pre></div><div class="public" id="var-clojure-on-origin"><h3>clojure-on-origin</h3><div class="usage"><code>(clojure-on-origin session f)</code></div><pre class="doc">Execute a clojure function on the origin
</pre></div><div class="public" id="var-echo-bash"><h3>echo-bash</h3><div class="usage"><code>(echo-bash session f)</code></div><pre class="doc">Echo a bash action. Do not execute.
</pre></div><div class="public" id="var-echo-clojure"><h3>echo-clojure</h3><div class="usage"><code>(echo-clojure session f)</code></div><pre class="doc">Echo a clojure action (which returns nil)
</pre></div><div class="public" id="var-echo-transfer"><h3>echo-transfer</h3><div class="usage"><code>(echo-transfer session f)</code></div><pre class="doc">echo transfer of files
</pre></div><div class="public" id="var-execute-echo"><h3>execute-echo</h3><div class="usage"><code>(execute-echo handler)</code></div><pre class="doc">Execute cmds for target on the local machine
</pre></div><div class="public" id="var-execute-target-on-localhost"><h3>execute-target-on-localhost</h3><div class="usage"><code>(execute-target-on-localhost handler)</code></div><pre class="doc">Execute cmds for target on the local machine
</pre></div><div class="public" id="var-execute-with-ssh"><h3>execute-with-ssh</h3><div class="usage"><code>(execute-with-ssh handler)</code></div><pre class="doc">Execute cmds for the session. Also accepts an IP or hostname as address.
</pre></div><div class="public" id="var-local-checked-script"><h3>local-checked-script</h3><div class="usage"><code>(local-checked-script msg &amp; body)</code></div><pre class="doc">Run a script on the local machine, setting up stevedore to produce the
correct target specific code.  The return code is checked.</pre></div><div class="public" id="var-local-cmds"><h3>local-cmds</h3><div class="usage"><code>(local-cmds commands)</code></div><pre class="doc">Run local cmds on a target.
</pre></div><div class="public" id="var-local-script"><h3>local-script</h3><div class="usage"><code>(local-script &amp; body)</code></div><pre class="doc">Run a script on the local machine, setting up stevedore to produce the
correct target specific code</pre></div><div class="public" id="var-local-script-expand"><h3>local-script-expand</h3><div class="usage"><code>(local-script-expand expr)</code></div><pre class="doc">Expand a script expression.
</pre></div><div class="public" id="var-output-poll-period"><h3>output-poll-period</h3><div class="usage"></div><pre class="doc">Specifies the polling period for retrieving ssh command output.
Defaults to 1000ms.</pre></div><div class="public" id="var-remote-exec"><h3>remote-exec</h3><div class="usage"><code>(remote-exec server command user)</code></div><pre class="doc">Run an ssh exec command on a server.
</pre></div><div class="public" id="var-remote-sudo"><h3>remote-sudo</h3><div class="usage"><code>(remote-sudo server command user {:keys [pty], :as options})</code></div><pre class="doc">Run a sudo command on a server.
</pre></div><div class="public" id="var-remote-sudo-cmd"><h3>remote-sudo-cmd</h3><div class="usage"><code>(remote-sudo-cmd server ssh-session sftp-channel user tmpfile command {:keys [pty], :or {pty true}, :as options})</code></div><pre class="doc">Execute remote command.
Copies `command` to `tmpfile` on the remote node using the `sftp-channel`
and executes the `tmpfile` as the specified `user`.</pre></div><div class="public" id="var-sh-script"><h3>sh-script</h3><div class="usage"><code>(sh-script command)</code></div><pre class="doc">Run a script on local machine.
</pre></div><div class="public" id="var-ssh-bash-on-target"><h3>ssh-bash-on-target</h3><div class="usage"><code>(ssh-bash-on-target session f)</code></div><pre class="doc">Execute a bash action on the target via ssh.
</pre></div><div class="public" id="var-ssh-from-local"><h3>ssh-from-local</h3><div class="usage"><code>(ssh-from-local session f)</code></div><pre class="doc">Transfer a file from the origin machine to the target via ssh.
</pre></div><div class="public" id="var-ssh-output-buffer-size"><h3>ssh-output-buffer-size</h3><div class="usage"></div><pre class="doc">Specifies the buffer size used to read the ssh output stream.
Defaults to 10K, to match clj-ssh.ssh/*piped-stream-buffer-size*</pre></div><div class="public" id="var-ssh-to-local"><h3>ssh-to-local</h3><div class="usage"><code>(ssh-to-local session f)</code></div><pre class="doc">Transfer a file from the origin machine to the target via ssh.
</pre></div><div class="public" id="var-ssh-user-credentials"><h3>ssh-user-credentials</h3><div class="usage"><code>(ssh-user-credentials handler)</code></div><pre class="doc">Middleware to user the session :user credentials for SSH authentication.
</pre></div><div class="public" id="var-sudo-cmd-for"><h3>sudo-cmd-for</h3><div class="usage"><code>(sudo-cmd-for user)</code></div><pre class="doc">Construct a sudo command prefix for the specified user.
</pre></div><div class="public" id="var-transfer-on-origin"><h3>transfer-on-origin</h3><div class="usage"><code>(transfer-on-origin session f)</code></div><pre class="doc">Transfer files on origin by copying
</pre></div><div class="public" id="var-verify-sh-return"><h3>verify-sh-return</h3><div class="usage"><code>(verify-sh-return msg cmd result)</code></div><pre class="doc">Verify the return code of a sh execution
</pre></div><div class="public" id="var-with-ssh-tunnel"><h3>with-ssh-tunnel</h3><div class="usage"><code>(with-ssh-tunnel session tunnels &amp; body)</code></div><pre class="doc">Execute the body with an ssh-tunnel available for the ports given in the
tunnels map. Automatically closes port forwards on completion.

Tunnels should be a map from local ports (integers) to either
  1) An integer remote port. Remote host is assumed to be &quot;localhost&quot;.
  2) A vector of remote host and remote port. eg, [&quot;yahoo.com&quot; 80].

e.g.
     (with-ssh-tunnel session {2222 22}
        ;; do something on local port 2222
        session)</pre></div></div></body></html>