<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>pallet.action documentation</title></head><body><div id="header"><h1><a href="index.html">Pallet 0.6.7-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3>Namespaces</h3><ul><li class="current"><a href="pallet.action.html">pallet.action</a></li><li><a href="pallet.action.conditional.html">pallet.action.conditional</a></li><li><a href="pallet.action.directory.html">pallet.action.directory</a></li><li><a href="pallet.action.environment.html">pallet.action.environment</a></li><li><a href="pallet.action.exec-script.html">pallet.action.exec-script</a></li><li><a href="pallet.action.file.html">pallet.action.file</a></li><li><a href="pallet.action.filesystem.html">pallet.action.filesystem</a></li><li><a href="pallet.action.package.html">pallet.action.package</a></li><li><a href="pallet.action.package.centos.html">pallet.action.package.centos</a></li><li><a href="pallet.action.package.debian-backports.html">pallet.action.package.debian-backports</a></li><li><a href="pallet.action.package.epel.html">pallet.action.package.epel</a></li><li><a href="pallet.action.package.jpackage.html">pallet.action.package.jpackage</a></li><li><a href="pallet.action.package.rpmforge.html">pallet.action.package.rpmforge</a></li><li><a href="pallet.action.remote-directory.html">pallet.action.remote-directory</a></li><li><a href="pallet.action.remote-file.html">pallet.action.remote-file</a></li><li><a href="pallet.action.retry.html">pallet.action.retry</a></li><li><a href="pallet.action.rsync.html">pallet.action.rsync</a></li><li><a href="pallet.action.service.html">pallet.action.service</a></li><li><a href="pallet.action.user.html">pallet.action.user</a></li><li><a href="pallet.action-plan.html">pallet.action-plan</a></li><li><a href="pallet.argument.html">pallet.argument</a></li><li><a href="pallet.blobstore.html">pallet.blobstore</a></li><li><a href="pallet.blobstore.implementation.html">pallet.blobstore.implementation</a></li><li><a href="pallet.blobstore.jclouds.html">pallet.blobstore.jclouds</a></li><li><a href="pallet.blobstore.url-blobstore.html">pallet.blobstore.url-blobstore</a></li><li><a href="pallet.command-line.html">pallet.command-line</a></li><li><a href="pallet.command-script.html">pallet.command-script</a></li><li><a href="pallet.compute.html">pallet.compute</a></li><li><a href="pallet.compute.hybrid.html">pallet.compute.hybrid</a></li><li><a href="pallet.compute.implementation.html">pallet.compute.implementation</a></li><li><a href="pallet.compute.jclouds.html">pallet.compute.jclouds</a></li><li><a href="pallet.compute.jvm.html">pallet.compute.jvm</a></li><li><a href="pallet.compute.node-list.html">pallet.compute.node-list</a></li><li><a href="pallet.compute.vmfest.html">pallet.compute.vmfest</a></li><li><a href="pallet.config-file.format.html">pallet.config-file.format</a></li><li><a href="pallet.configure.html">pallet.configure</a></li><li><a href="pallet.core.html">pallet.core</a></li><li><a href="pallet.crate.network-service.html">pallet.crate.network-service</a></li><li><a href="pallet.debug.html">pallet.debug</a></li><li><a href="pallet.enlive.html">pallet.enlive</a></li><li><a href="pallet.environment.html">pallet.environment</a></li><li><a href="pallet.execute.html">pallet.execute</a></li><li><a href="pallet.futures.html">pallet.futures</a></li><li><a href="pallet.main.html">pallet.main</a></li><li><a href="pallet.main-invoker.html">pallet.main-invoker</a></li><li><a href="pallet.map-merge.html">pallet.map-merge</a></li><li><a href="pallet.maven.html">pallet.maven</a></li><li><a href="pallet.md5crypt.html">pallet.md5crypt</a></li><li><a href="pallet.node.html">pallet.node</a></li><li><a href="pallet.parameter.html">pallet.parameter</a></li><li><a href="pallet.phase.html">pallet.phase</a></li><li><a href="pallet.repl.html">pallet.repl</a></li><li><a href="pallet.request-map.html">pallet.request-map</a></li><li><a href="pallet.resource.html">pallet.resource</a></li><li><a href="pallet.resource.directory.html">pallet.resource.directory</a></li><li><a href="pallet.resource.exec-script.html">pallet.resource.exec-script</a></li><li><a href="pallet.resource.file.html">pallet.resource.file</a></li><li><a href="pallet.resource.filesystem.html">pallet.resource.filesystem</a></li><li><a href="pallet.resource.filesystem-layout.html">pallet.resource.filesystem-layout</a></li><li><a href="pallet.resource.format.html">pallet.resource.format</a></li><li><a href="pallet.resource.hostinfo.html">pallet.resource.hostinfo</a></li><li><a href="pallet.resource.lib.html">pallet.resource.lib</a></li><li><a href="pallet.resource.network-service.html">pallet.resource.network-service</a></li><li><a href="pallet.resource.package.html">pallet.resource.package</a></li><li><a href="pallet.resource.remote-directory.html">pallet.resource.remote-directory</a></li><li><a href="pallet.resource.remote-file.html">pallet.resource.remote-file</a></li><li><a href="pallet.resource.resource-when.html">pallet.resource.resource-when</a></li><li><a href="pallet.resource.rsync.html">pallet.resource.rsync</a></li><li><a href="pallet.resource.service.html">pallet.resource.service</a></li><li><a href="pallet.resource.shell.html">pallet.resource.shell</a></li><li><a href="pallet.resource.user.html">pallet.resource.user</a></li><li><a href="pallet.script.lib.html">pallet.script.lib</a></li><li><a href="pallet.session.html">pallet.session</a></li><li><a href="pallet.shell.html">pallet.shell</a></li><li><a href="pallet.strint.html">pallet.strint</a></li><li><a href="pallet.target.html">pallet.target</a></li><li><a href="pallet.task.add-service.html">pallet.task.add-service</a></li><li><a href="pallet.task.containers.html">pallet.task.containers</a></li><li><a href="pallet.task.converge.html">pallet.task.converge</a></li><li><a href="pallet.task.converge-cluster.html">pallet.task.converge-cluster</a></li><li><a href="pallet.task.describe-node.html">pallet.task.describe-node</a></li><li><a href="pallet.task.destroy-cluster.html">pallet.task.destroy-cluster</a></li><li><a href="pallet.task.help.html">pallet.task.help</a></li><li><a href="pallet.task.images.html">pallet.task.images</a></li><li><a href="pallet.task.lift.html">pallet.task.lift</a></li><li><a href="pallet.task.new-project.html">pallet.task.new-project</a></li><li><a href="pallet.task.nodes.html">pallet.task.nodes</a></li><li><a href="pallet.task.providers.html">pallet.task.providers</a></li><li><a href="pallet.task.to-blob.html">pallet.task.to-blob</a></li><li><a href="pallet.task.version.html">pallet.task.version</a></li><li><a href="pallet.task.vmfest-script.html">pallet.task.vmfest-script</a></li><li><a href="pallet.template.html">pallet.template</a></li><li><a href="pallet.template.properties.html">pallet.template.properties</a></li><li><a href="pallet.utils.html">pallet.utils</a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="pallet.action.html#var-action">action</a></li><li><a href="pallet.action.html#var-action-fn">action-fn</a></li><li><a href="pallet.action.html#var-action-metadata">action-metadata</a></li><li><a href="pallet.action.html#var-aggregated-action">aggregated-action</a></li><li><a href="pallet.action.html#var-as-clj-action">as-clj-action</a></li><li><a href="pallet.action.html#var-bash-action">bash-action</a></li><li><a href="pallet.action.html#var-clj-action">clj-action</a></li><li><a href="pallet.action.html#var-collected-action">collected-action</a></li><li><a href="pallet.action.html#var-def-action-def">def-action-def</a></li><li><a href="pallet.action.html#var-enter-scope">enter-scope</a></li><li><a href="pallet.action.html#var-leave-scope">leave-scope</a></li><li><a href="pallet.action.html#var-schedule-action">schedule-action</a></li><li><a href="pallet.action.html#var-with-precedence">with-precedence</a></li></ul></div><div class="namespace-docs" id="content"><h2>pallet.action documentation</h2><pre class="doc">Actions implement the conversion of phase functions to script and other
execution code.

An action has a :action-type. Known types include :script/bash
and :fn/clojure.

An action has a :location, :origin for execution on the node running
pallet, and :target for the target node.

An action has an :execution, which is one of :aggregated, :in-sequence or
:collected. Calls to :aggregated actions will be grouped, and run before
:in-sequence actions. Calls to :collected actions will be grouped, and run
after :in-sequence actions.</pre><div class="public" id="var-action"><h3>action</h3><div class="usage"><code>(action execution action-type location [session &amp; args] &amp; body)</code></div><pre class="doc">Define an anonymous action
</pre></div><div class="public" id="var-action-fn"><h3>action-fn</h3><div class="usage"><code>(action-fn action)</code></div><pre class="doc">Retrieve the action-fn that is used to execute the specified action.
</pre></div><div class="public" id="var-action-metadata"><h3>action-metadata</h3><div class="usage"><code>(action-metadata session f)</code></div><pre class="doc">Compute action metadata from precedence specification in session
</pre></div><div class="public" id="var-aggregated-action"><h3>aggregated-action</h3><div class="usage"><code>(aggregated-action [session &amp; args] &amp; body)</code></div><pre class="doc">Define a remotely executed aggregated action function, which will
be executed before :in-sequence actions.</pre></div><div class="public" id="var-as-clj-action"><h3>as-clj-action</h3><div class="usage"><code>(as-clj-action f [session &amp; args])</code><code>(as-clj-action f)</code></div><pre class="doc">An adaptor for using a normal function as a local action function
</pre></div><div class="public" id="var-bash-action"><h3>bash-action</h3><div class="usage"><code>(bash-action [session &amp; args] &amp; body)</code></div><pre class="doc">Define a remotely executed bash action function.
</pre></div><div class="public" id="var-clj-action"><h3>clj-action</h3><div class="usage"><code>(clj-action [session &amp; args] &amp; body)</code></div><pre class="doc">Define a clojure action to be executed on the origin machine.
</pre></div><div class="public" id="var-collected-action"><h3>collected-action</h3><div class="usage"><code>(collected-action [session &amp; args] &amp; body)</code></div><pre class="doc">Define a remotely executed collected action function, which will
be executed after :in-sequence actions.</pre></div><div class="public" id="var-def-action-def"><h3>def-action-def</h3><div class="usage"><code>(def-action-def name actionfn1)</code></div><pre class="doc">Define a macro for definining action defining vars
</pre></div><div class="public" id="var-enter-scope"><h3>enter-scope</h3><div class="usage"><code>(enter-scope session)</code></div><pre class="doc">Enter a new action scope.
</pre></div><div class="public" id="var-leave-scope"><h3>leave-scope</h3><div class="usage"><code>(leave-scope session)</code></div><pre class="doc">Leave the current action scope.
</pre></div><div class="public" id="var-schedule-action"><h3>schedule-action</h3><div class="usage"><code>(schedule-action session action-fn metadata args execution action-type location)</code></div><pre class="doc">Registers an action in the action plan. The action is generated by the
specified action function and arguments that will be applied to the function
when the action plan is executed.

The action can be scheduled within one of three 'executions'
(conceptually, sub-phases):

:in-sequence - The generated action will be applied to the node
     &quot;in order&quot;, as it is defined lexically in the source crate.
     This is the default.
:aggregated - All aggregated actions are applied to the node
     in the order they are defined, but before all :in-sequence
     actions. Note that all of the arguments to any given
     action function are gathered such that there is only ever one
     invocation of each fn within each phase.
:collected - All collected actions are applied to the node
     in the order they are defined, but after all :in-sequence
     action. Note that all of the arguments to any given
     action function are gathered such that there is only ever one
     invocation of each fn within each phase.

The action-type determines how the action should be handled:

:script/bash - action produces bash script for execution on remote machine
:fn/clojure  - action is a function for local execution
:transfer/to-local - action is a function specifying remote source
                     and local destination.
:transfer/from-local - action is a function specifying local source
                       and remote destination.</pre></div><div class="public" id="var-with-precedence"><h3>with-precedence</h3><div class="usage"><code>(with-precedence request m &amp; body)</code></div><pre class="doc">Set up local precedence relations between actions
</pre></div></div></body></html>