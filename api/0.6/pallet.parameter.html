<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>pallet.parameter documentation</title></head><body><div id="header"><h1><a href="index.html">Pallet 0.6 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3>Namespaces</h3><ul><li><a href="pallet.action.html">pallet.action</a></li><li><a href="pallet.action.conditional.html">pallet.action.conditional</a></li><li><a href="pallet.action.directory.html">pallet.action.directory</a></li><li><a href="pallet.action.environment.html">pallet.action.environment</a></li><li><a href="pallet.action.exec-script.html">pallet.action.exec-script</a></li><li><a href="pallet.action.file.html">pallet.action.file</a></li><li><a href="pallet.action.filesystem.html">pallet.action.filesystem</a></li><li><a href="pallet.action.package.html">pallet.action.package</a></li><li><a href="pallet.action.package.centos.html">pallet.action.package.centos</a></li><li><a href="pallet.action.package.debian-backports.html">pallet.action.package.debian-backports</a></li><li><a href="pallet.action.package.epel.html">pallet.action.package.epel</a></li><li><a href="pallet.action.package.jpackage.html">pallet.action.package.jpackage</a></li><li><a href="pallet.action.package.rpmforge.html">pallet.action.package.rpmforge</a></li><li><a href="pallet.action.remote-directory.html">pallet.action.remote-directory</a></li><li><a href="pallet.action.remote-file.html">pallet.action.remote-file</a></li><li><a href="pallet.action.retry.html">pallet.action.retry</a></li><li><a href="pallet.action.rsync.html">pallet.action.rsync</a></li><li><a href="pallet.action.service.html">pallet.action.service</a></li><li><a href="pallet.action.user.html">pallet.action.user</a></li><li><a href="pallet.action-plan.html">pallet.action-plan</a></li><li><a href="pallet.argument.html">pallet.argument</a></li><li><a href="pallet.blobstore.html">pallet.blobstore</a></li><li><a href="pallet.blobstore.implementation.html">pallet.blobstore.implementation</a></li><li><a href="pallet.blobstore.jclouds.html">pallet.blobstore.jclouds</a></li><li><a href="pallet.blobstore.url-blobstore.html">pallet.blobstore.url-blobstore</a></li><li><a href="pallet.command-line.html">pallet.command-line</a></li><li><a href="pallet.command-script.html">pallet.command-script</a></li><li><a href="pallet.compute.html">pallet.compute</a></li><li><a href="pallet.compute.hybrid.html">pallet.compute.hybrid</a></li><li><a href="pallet.compute.implementation.html">pallet.compute.implementation</a></li><li><a href="pallet.compute.jclouds.html">pallet.compute.jclouds</a></li><li><a href="pallet.compute.jvm.html">pallet.compute.jvm</a></li><li><a href="pallet.compute.node-list.html">pallet.compute.node-list</a></li><li><a href="pallet.compute.vmfest.html">pallet.compute.vmfest</a></li><li><a href="pallet.config-file.format.html">pallet.config-file.format</a></li><li><a href="pallet.configure.html">pallet.configure</a></li><li><a href="pallet.core.html">pallet.core</a></li><li><a href="pallet.crate.network-service.html">pallet.crate.network-service</a></li><li><a href="pallet.debug.html">pallet.debug</a></li><li><a href="pallet.enlive.html">pallet.enlive</a></li><li><a href="pallet.environment.html">pallet.environment</a></li><li><a href="pallet.execute.html">pallet.execute</a></li><li><a href="pallet.futures.html">pallet.futures</a></li><li><a href="pallet.main.html">pallet.main</a></li><li><a href="pallet.main-invoker.html">pallet.main-invoker</a></li><li><a href="pallet.map-merge.html">pallet.map-merge</a></li><li><a href="pallet.maven.html">pallet.maven</a></li><li><a href="pallet.md5crypt.html">pallet.md5crypt</a></li><li><a href="pallet.node.html">pallet.node</a></li><li class="current"><a href="pallet.parameter.html">pallet.parameter</a></li><li><a href="pallet.phase.html">pallet.phase</a></li><li><a href="pallet.repl.html">pallet.repl</a></li><li><a href="pallet.request-map.html">pallet.request-map</a></li><li><a href="pallet.resource.html">pallet.resource</a></li><li><a href="pallet.resource.directory.html">pallet.resource.directory</a></li><li><a href="pallet.resource.exec-script.html">pallet.resource.exec-script</a></li><li><a href="pallet.resource.file.html">pallet.resource.file</a></li><li><a href="pallet.resource.filesystem.html">pallet.resource.filesystem</a></li><li><a href="pallet.resource.filesystem-layout.html">pallet.resource.filesystem-layout</a></li><li><a href="pallet.resource.format.html">pallet.resource.format</a></li><li><a href="pallet.resource.hostinfo.html">pallet.resource.hostinfo</a></li><li><a href="pallet.resource.lib.html">pallet.resource.lib</a></li><li><a href="pallet.resource.network-service.html">pallet.resource.network-service</a></li><li><a href="pallet.resource.package.html">pallet.resource.package</a></li><li><a href="pallet.resource.remote-directory.html">pallet.resource.remote-directory</a></li><li><a href="pallet.resource.remote-file.html">pallet.resource.remote-file</a></li><li><a href="pallet.resource.resource-when.html">pallet.resource.resource-when</a></li><li><a href="pallet.resource.rsync.html">pallet.resource.rsync</a></li><li><a href="pallet.resource.service.html">pallet.resource.service</a></li><li><a href="pallet.resource.shell.html">pallet.resource.shell</a></li><li><a href="pallet.resource.user.html">pallet.resource.user</a></li><li><a href="pallet.script.lib.html">pallet.script.lib</a></li><li><a href="pallet.session.html">pallet.session</a></li><li><a href="pallet.shell.html">pallet.shell</a></li><li><a href="pallet.strint.html">pallet.strint</a></li><li><a href="pallet.target.html">pallet.target</a></li><li><a href="pallet.task.add-service.html">pallet.task.add-service</a></li><li><a href="pallet.task.containers.html">pallet.task.containers</a></li><li><a href="pallet.task.converge.html">pallet.task.converge</a></li><li><a href="pallet.task.converge-cluster.html">pallet.task.converge-cluster</a></li><li><a href="pallet.task.describe-node.html">pallet.task.describe-node</a></li><li><a href="pallet.task.destroy-cluster.html">pallet.task.destroy-cluster</a></li><li><a href="pallet.task.help.html">pallet.task.help</a></li><li><a href="pallet.task.images.html">pallet.task.images</a></li><li><a href="pallet.task.lift.html">pallet.task.lift</a></li><li><a href="pallet.task.new-project.html">pallet.task.new-project</a></li><li><a href="pallet.task.nodes.html">pallet.task.nodes</a></li><li><a href="pallet.task.providers.html">pallet.task.providers</a></li><li><a href="pallet.task.to-blob.html">pallet.task.to-blob</a></li><li><a href="pallet.task.version.html">pallet.task.version</a></li><li><a href="pallet.task.vmfest-script.html">pallet.task.vmfest-script</a></li><li><a href="pallet.template.html">pallet.template</a></li><li><a href="pallet.template.properties.html">pallet.template.properties</a></li><li><a href="pallet.utils.html">pallet.utils</a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="pallet.parameter.html#var-assoc-for">assoc-for</a></li><li><a href="pallet.parameter.html#var-assoc-for-service">assoc-for-service</a></li><li><a href="pallet.parameter.html#var-assoc-for-target">assoc-for-target</a></li><li><a href="pallet.parameter.html#var-assoc-target-settings">assoc-target-settings</a></li><li><a href="pallet.parameter.html#var-from-map">from-map</a></li><li><a href="pallet.parameter.html#var-get-for">get-for</a></li><li><a href="pallet.parameter.html#var-get-for-service">get-for-service</a></li><li><a href="pallet.parameter.html#var-get-for-target">get-for-target</a></li><li><a href="pallet.parameter.html#var-get-node-settings">get-node-settings</a></li><li><a href="pallet.parameter.html#var-get-target-settings">get-target-settings</a></li><li><a href="pallet.parameter.html#var-lookup">lookup</a></li><li><a href="pallet.parameter.html#var-lookup-for-target">lookup-for-target</a></li><li><a href="pallet.parameter.html#var-parameters">parameters</a></li><li><a href="pallet.parameter.html#var-update-for">update-for</a></li><li><a href="pallet.parameter.html#var-update-for-service">update-for-service</a></li><li><a href="pallet.parameter.html#var-update-for-target">update-for-target</a></li><li><a href="pallet.parameter.html#var-update-target-settings">update-target-settings</a></li></ul></div><div class="namespace-docs" id="content"><h2>pallet.parameter documentation</h2><pre class="doc">Provides functions for working with parameters.

Parameters are data maps that allow propogation of information between the
functions of a crate, and between crates. There are two conventions for using
parameters in crates that are directly supported here.

Host specific parameters are specified under
    [:parameters :host (keyword target-id)]
These functions are `get-for-target`, `assoc-for-target`, and
`update-for-target`.

Service specific paramters, used across hosts, are specified under
   [:parameters :service (keyword service-name)]
These functions are `get-for-service`, `assoc-for-service`, and
`update-for-service`.

The `get-for` functions have slightly different semantics compared with
clojure.core/get, in that they throw an exception if the key is undefined
and no default value is specified.

Delayed evaluation of parameters specified as arguments to action functions
are also implemented here. `lookup` and `lookup-for-target`.</pre><div class="public" id="var-assoc-for"><h3>assoc-for</h3><div class="usage"><code>(assoc-for session &amp; {:as keys-value-pairs})</code></div><pre class="doc">Set the :parameters values at the paths specified.

(assoc-for {} [:a :b] 1 [:a :d] 2)
  =&gt; {:parameters {:a {:b 1} {:d 2}}}</pre></div><div class="public" id="var-assoc-for-service"><h3>assoc-for-service</h3><div class="usage"><code>(assoc-for-service session service &amp; {:as keys-value-pairs})</code></div><pre class="doc">Set the service parameter values at the paths specified.

(assoc-for-service {} :proxy [:a :b] 1 [:a :d] 2)
  =&gt; {:parameters {:srvice {:proxy {:a {:b 1} {:d 2}}}}}</pre></div><div class="public" id="var-assoc-for-target"><h3>assoc-for-target</h3><div class="usage"><code>(assoc-for-target session &amp; {:as keys-value-pairs})</code></div><pre class="doc">Set the host parameter values at the paths specified.

(assoc-for-target {:target-id :id1} [:a :b] 1 [:a :d] 2)
  =&gt; {:parameters {:host {:id1 {:a {:b 1} {:d 2}}}}}</pre></div><div class="public" id="var-assoc-target-settings"><h3>assoc-target-settings</h3><div class="usage"><code>(assoc-target-settings session facility instance-id values)</code></div><pre class="doc">Set the settings for the specified host facility. The instance-id allows
the specification of specific instance of the facility (the default is
:default).</pre></div><div class="public" id="var-from-map"><h3>from-map</h3><div class="usage"><code>(from-map m keys)</code></div><pre class="doc">Initialise parameters based on the given keys, which are used to merge maps
from m.</pre></div><div class="public" id="var-get-for"><h3>get-for</h3><div class="usage"><code>(get-for session keys)</code><code>(get-for session keys default)</code></div><pre class="doc">Retrieve the parameter at the path specified by keys.
When no default value is specified, then raise a :parameter-not-found if no
parameter is set.

    (get-for {:p {:a {:b 1} {:d 2}}} [:p :a :d])
      =&gt; 2</pre></div><div class="public" id="var-get-for-service"><h3>get-for-service</h3><div class="usage"><code>(get-for-service session keys)</code><code>(get-for-service session keys default)</code></div><pre class="doc">Retrieve the service parameter for the service and path specified by
keys.  When no default value is specified, then raise a :parameter-not-found
if no parameter is set.

    (get-for-service
      {:parameters {:service {:proxy {:a {:b 1} {:d 2}}}}} [:proxy :a :b])
      =&gt; 1</pre></div><div class="public" id="var-get-for-target"><h3>get-for-target</h3><div class="usage"><code>(get-for-target session keys)</code><code>(get-for-target session keys default)</code></div><pre class="doc">Retrieve the host parameter for the current target at the path specified by
keys.  When no default value is specified, then raise a :parameter-not-found
if no parameter is set.

    (get-for-target
      {:parameters {:host {:id1 {:a {:b 1} {:d 2}}}}
       :target-id :id1} [:a :b])
      =&gt; 1</pre></div><div class="public" id="var-get-node-settings"><h3>get-node-settings</h3><div class="usage"><code>(get-node-settings session node facility instance-id)</code></div><pre class="doc">Retrieve the settings for the specified node facility. The instance-id allows
the specification of specific instance of the facility. If passed a nil
`instance-id`, then `:default` is used</pre></div><div class="public" id="var-get-target-settings"><h3>get-target-settings</h3><div class="usage"><code>(get-target-settings session facility instance-id)</code><code>(get-target-settings session facility instance-id default)</code></div><pre class="doc">Retrieve the settings for the specified host facility. The instance-id allows
the specification of specific instance of the facility. If passed a nil
`instance-id`, then `:default` is used</pre></div><div class="public" id="var-lookup"><h3>lookup</h3><div class="usage"><code>(lookup &amp; keys)</code></div><pre class="doc">Lookup a parameter in a delayed manner. Use a call to this function as the
argument of a action.
This function produces an object, which causes parameter lookup when it's
toString method is called.

See also `pallet.argument`.</pre></div><div class="public" id="var-lookup-for-target"><h3>lookup-for-target</h3><div class="usage"><code>(lookup-for-target &amp; keys)</code></div><pre class="doc">Lookup a parameter for the target in a delayed manner. Use a call to this
function as the argument of a action.  This function produces an object,
which causes parameter lookup when it's toString method is called.

See also `pallet.argument`.</pre></div><div class="public" id="var-parameters"><h3>parameters</h3><div class="usage"><code>(parameters session &amp; {:as keyvector-value-pairs})</code></div><pre class="doc">An action to set parameters
</pre></div><div class="public" id="var-update-for"><h3>update-for</h3><div class="usage"><code>(update-for session keys f &amp; args)</code></div><pre class="doc">Update parameters at the path given by keys.
The value is set to the value return by calling f with the current
value and the given args.

    (update-for {:parameters {:a {:b 1}}} [:a :b] + 2)
      =&gt; {:parameters {:a {:b 3}}}</pre></div><div class="public" id="var-update-for-service"><h3>update-for-service</h3><div class="usage"><code>(update-for-service session keys f &amp; args)</code></div><pre class="doc">Update serivce parameters for the pecified service at the path given by keys.
The value is set to the value return by calling f with the current
value and the given args.

    (update-for-service
       {:parameters {:service {:proxy {:a {:b 1}}}}}
       [:proxy :a :b] + 2)
      =&gt; {:parameters {:service {:proxy {:a {:b 3}}}}}</pre></div><div class="public" id="var-update-for-target"><h3>update-for-target</h3><div class="usage"><code>(update-for-target session keys f &amp; args)</code></div><pre class="doc">Update host parameters for the current target at the path given by keys.
The value is set to the value return by calling f with the current
value and the given args.

    (update-for-target
       {:parameters {:host {:id1 {:a {:b 1}}}}
        :target-id :id1}
       [:a :b] + 2)
      =&gt; {:parameters {:host {:id1 {:a {:b 3}}}}}</pre></div><div class="public" id="var-update-target-settings"><h3>update-target-settings</h3><div class="usage"><code>(update-target-settings session facility instance-id f &amp; args)</code></div><pre class="doc">Update the settings for the specified host facility. The instance-id allows
the specification of specific instance of the facility (the default is
:default).</pre></div></div></body></html>