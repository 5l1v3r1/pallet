<html lang="en">
  <head>
    <title>pallet.execute documentation</title>
    <link href="css/default.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/page_effects.js"></script>
  </head>
  <body>
    <header>
      <div id="header">
        <h1 class="project-title">Pallet 0.7 API documentation</h1>
      </div>
    </header>
    <navigation>
      <div id="namespaces" class="sidebar">
        <h3>Namespaces</h3>
        <ul class="ns-links">
          <li class="ns-link"><a href="pallet.action.html">pallet.action</a></li><li class="ns-link"><a href="pallet.action.conditional.html">pallet.action.conditional</a></li><li class="ns-link"><a href="pallet.action.directory.html">pallet.action.directory</a></li><li class="ns-link"><a href="pallet.action.environment.html">pallet.action.environment</a></li><li class="ns-link"><a href="pallet.action.exec-script.html">pallet.action.exec-script</a></li><li class="ns-link"><a href="pallet.action.file.html">pallet.action.file</a></li><li class="ns-link"><a href="pallet.action.filesystem.html">pallet.action.filesystem</a></li><li class="ns-link"><a href="pallet.action.package.html">pallet.action.package</a></li><li class="ns-link"><a href="pallet.action.package.centos.html">pallet.action.package.centos</a></li><li class="ns-link"><a href="pallet.action.package.debian-backports.html">pallet.action.package.debian-backports</a></li><li class="ns-link"><a href="pallet.action.package.epel.html">pallet.action.package.epel</a></li><li class="ns-link"><a href="pallet.action.package.jpackage.html">pallet.action.package.jpackage</a></li><li class="ns-link"><a href="pallet.action.package.rpmforge.html">pallet.action.package.rpmforge</a></li><li class="ns-link"><a href="pallet.action.remote-directory.html">pallet.action.remote-directory</a></li><li class="ns-link"><a href="pallet.action.remote-file.html">pallet.action.remote-file</a></li><li class="ns-link"><a href="pallet.action.retry.html">pallet.action.retry</a></li><li class="ns-link"><a href="pallet.action.rsync.html">pallet.action.rsync</a></li><li class="ns-link"><a href="pallet.action.service.html">pallet.action.service</a></li><li class="ns-link"><a href="pallet.action.user.html">pallet.action.user</a></li><li class="ns-link"><a href="pallet.action-plan.html">pallet.action-plan</a></li><li class="ns-link"><a href="pallet.argument.html">pallet.argument</a></li><li class="ns-link"><a href="pallet.blobstore.html">pallet.blobstore</a></li><li class="ns-link"><a href="pallet.blobstore.implementation.html">pallet.blobstore.implementation</a></li><li class="ns-link"><a href="pallet.blobstore.url-blobstore.html">pallet.blobstore.url-blobstore</a></li><li class="ns-link"><a href="pallet.command-line.html">pallet.command-line</a></li><li class="ns-link"><a href="pallet.command-script.html">pallet.command-script</a></li><li class="ns-link"><a href="pallet.compute.html">pallet.compute</a></li><li class="ns-link"><a href="pallet.compute.hybrid.html">pallet.compute.hybrid</a></li><li class="ns-link"><a href="pallet.compute.implementation.html">pallet.compute.implementation</a></li><li class="ns-link"><a href="pallet.compute.jvm.html">pallet.compute.jvm</a></li><li class="ns-link"><a href="pallet.compute.node-list.html">pallet.compute.node-list</a></li><li class="ns-link"><a href="pallet.config-file.format.html">pallet.config-file.format</a></li><li class="ns-link"><a href="pallet.configure.html">pallet.configure</a></li><li class="ns-link"><a href="pallet.core.html">pallet.core</a></li><li class="ns-link"><a href="pallet.crate.automated-admin-user.html">pallet.crate.automated-admin-user</a></li><li class="ns-link"><a href="pallet.crate.crontab.html">pallet.crate.crontab</a></li><li class="ns-link"><a href="pallet.crate.environment.html">pallet.crate.environment</a></li><li class="ns-link"><a href="pallet.crate.etc-default.html">pallet.crate.etc-default</a></li><li class="ns-link"><a href="pallet.crate.etc-hosts.html">pallet.crate.etc-hosts</a></li><li class="ns-link"><a href="pallet.crate.limits-conf.html">pallet.crate.limits-conf</a></li><li class="ns-link"><a href="pallet.crate.network-service.html">pallet.crate.network-service</a></li><li class="ns-link"><a href="pallet.crate.package-repo.html">pallet.crate.package-repo</a></li><li class="ns-link"><a href="pallet.crate.ssh-key.html">pallet.crate.ssh-key</a></li><li class="ns-link"><a href="pallet.crate.sudoers.html">pallet.crate.sudoers</a></li><li class="ns-link"><a href="pallet.crate-install.html">pallet.crate-install</a></li><li class="ns-link"><a href="pallet.debug.html">pallet.debug</a></li><li class="ns-link"><a href="pallet.enlive.html">pallet.enlive</a></li><li class="ns-link"><a href="pallet.environment.html">pallet.environment</a></li><li class="ns-link"><a href="pallet.execute.html">pallet.execute</a></li><li class="ns-link"><a href="pallet.futures.html">pallet.futures</a></li><li class="ns-link"><a href="pallet.main.html">pallet.main</a></li><li class="ns-link"><a href="pallet.main-invoker.html">pallet.main-invoker</a></li><li class="ns-link"><a href="pallet.map-merge.html">pallet.map-merge</a></li><li class="ns-link"><a href="pallet.md5crypt.html">pallet.md5crypt</a></li><li class="ns-link"><a href="pallet.node.html">pallet.node</a></li><li class="ns-link"><a href="pallet.parameter.html">pallet.parameter</a></li><li class="ns-link"><a href="pallet.phase.html">pallet.phase</a></li><li class="ns-link"><a href="pallet.repl.html">pallet.repl</a></li><li class="ns-link"><a href="pallet.request-map.html">pallet.request-map</a></li><li class="ns-link"><a href="pallet.resource.html">pallet.resource</a></li><li class="ns-link"><a href="pallet.resource.directory.html">pallet.resource.directory</a></li><li class="ns-link"><a href="pallet.resource.exec-script.html">pallet.resource.exec-script</a></li><li class="ns-link"><a href="pallet.resource.file.html">pallet.resource.file</a></li><li class="ns-link"><a href="pallet.resource.filesystem.html">pallet.resource.filesystem</a></li><li class="ns-link"><a href="pallet.resource.filesystem-layout.html">pallet.resource.filesystem-layout</a></li><li class="ns-link"><a href="pallet.resource.format.html">pallet.resource.format</a></li><li class="ns-link"><a href="pallet.resource.hostinfo.html">pallet.resource.hostinfo</a></li><li class="ns-link"><a href="pallet.resource.lib.html">pallet.resource.lib</a></li><li class="ns-link"><a href="pallet.resource.network-service.html">pallet.resource.network-service</a></li><li class="ns-link"><a href="pallet.resource.package.html">pallet.resource.package</a></li><li class="ns-link"><a href="pallet.resource.remote-directory.html">pallet.resource.remote-directory</a></li><li class="ns-link"><a href="pallet.resource.remote-file.html">pallet.resource.remote-file</a></li><li class="ns-link"><a href="pallet.resource.resource-when.html">pallet.resource.resource-when</a></li><li class="ns-link"><a href="pallet.resource.rsync.html">pallet.resource.rsync</a></li><li class="ns-link"><a href="pallet.resource.service.html">pallet.resource.service</a></li><li class="ns-link"><a href="pallet.resource.shell.html">pallet.resource.shell</a></li><li class="ns-link"><a href="pallet.resource.user.html">pallet.resource.user</a></li><li class="ns-link"><a href="pallet.script.lib.html">pallet.script.lib</a></li><li class="ns-link"><a href="pallet.session.html">pallet.session</a></li><li class="ns-link"><a href="pallet.shell.html">pallet.shell</a></li><li class="ns-link"><a href="pallet.strint.html">pallet.strint</a></li><li class="ns-link"><a href="pallet.target.html">pallet.target</a></li><li class="ns-link"><a href="pallet.task.html">pallet.task</a></li><li class="ns-link"><a href="pallet.task.add-service.html">pallet.task.add-service</a></li><li class="ns-link"><a href="pallet.task.config.html">pallet.task.config</a></li><li class="ns-link"><a href="pallet.task.containers.html">pallet.task.containers</a></li><li class="ns-link"><a href="pallet.task.converge.html">pallet.task.converge</a></li><li class="ns-link"><a href="pallet.task.describe-node.html">pallet.task.describe-node</a></li><li class="ns-link"><a href="pallet.task.help.html">pallet.task.help</a></li><li class="ns-link"><a href="pallet.task.images.html">pallet.task.images</a></li><li class="ns-link"><a href="pallet.task.lift.html">pallet.task.lift</a></li><li class="ns-link"><a href="pallet.task.nodes.html">pallet.task.nodes</a></li><li class="ns-link"><a href="pallet.task.providers.html">pallet.task.providers</a></li><li class="ns-link"><a href="pallet.task.to-blob.html">pallet.task.to-blob</a></li><li class="ns-link"><a href="pallet.task.version.html">pallet.task.version</a></li><li class="ns-link"><a href="pallet.template.html">pallet.template</a></li><li class="ns-link"><a href="pallet.template.properties.html">pallet.template.properties</a></li><li class="ns-link"><a href="pallet.utils.html">pallet.utils</a></li><li class="ns-link"><a href="pallet.version-dispatch.html">pallet.version-dispatch</a></li><li class="ns-link"><a href="pallet.versions.html">pallet.versions</a></li>
        </ul>
      </div>
      <div id="vars" class="sidebar">
        <h3>Public Vars</h3>
        <ul class="ns-var-links">
          <li class="ns-var-link"><a href="pallet.execute.html#var-bash-command">bash-command</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-bash-on-origin">bash-on-origin</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-clojure-on-origin">clojure-on-origin</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-echo-bash">echo-bash</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-echo-clojure">echo-clojure</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-echo-transfer">echo-transfer</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-execute-echo">execute-echo</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-execute-target-on-localhost">execute-target-on-localhost</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-execute-with-ssh">execute-with-ssh</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-local-checked-script">local-checked-script</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-local-cmds">local-cmds</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-local-script">local-script</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-local-script-expand">local-script-expand</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-output-poll-period">output-poll-period</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-remote-exec">remote-exec</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-remote-sudo">remote-sudo</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-remote-sudo-cmd">remote-sudo-cmd</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-sh-script">sh-script</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-ssh-bash-on-target">ssh-bash-on-target</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-ssh-from-local">ssh-from-local</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-ssh-output-buffer-size">ssh-output-buffer-size</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-ssh-to-local">ssh-to-local</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-ssh-user-credentials">ssh-user-credentials</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-sudo-cmd-for">sudo-cmd-for</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-transfer-on-origin">transfer-on-origin</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-verify-sh-return">verify-sh-return</a></li><li class="ns-var-link"><a href="pallet.execute.html#var-with-ssh-tunnel">with-ssh-tunnel</a></li>
        </ul>
      </div>
    </navigation>
    <article>
      <div id="content" class="namespace-docs">
        <h2 class="namespace-title">pallet.execute documentation</h2>
        <div class="doc"><p>Exectute commands.  At the moment the only available transport is ssh.</p>
</div>
        <div class="ns-vars">
          <div class="public">
            <h3 id="var-bash-command">bash-command</h3>
            <div class="usage">[expr]</div>
            
            
            <div class="doc"><p>Adds an explicit bash invocation to a script command string.</p>
</div>
          </div><div class="public">
            <h3 id="var-bash-on-origin">bash-on-origin</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Execute a bash action on the origin</p>
</div>
          </div><div class="public">
            <h3 id="var-clojure-on-origin">clojure-on-origin</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Execute a clojure function on the origin</p>
</div>
          </div><div class="public">
            <h3 id="var-echo-bash">echo-bash</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Echo a bash action. Do not execute.</p>
</div>
          </div><div class="public">
            <h3 id="var-echo-clojure">echo-clojure</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Echo a clojure action (which returns nil)</p>
</div>
          </div><div class="public">
            <h3 id="var-echo-transfer">echo-transfer</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>echo transfer of files</p>
</div>
          </div><div class="public">
            <h3 id="var-execute-echo">execute-echo</h3>
            <div class="usage">[handler]</div>
            
            
            <div class="doc"><p>Execute cmds for target on the local machine</p>
</div>
          </div><div class="public">
            <h3 id="var-execute-target-on-localhost">execute-target-on-localhost</h3>
            <div class="usage">[handler]</div>
            
            
            <div class="doc"><p>Execute cmds for target on the local machine</p>
</div>
          </div><div class="public">
            <h3 id="var-execute-with-ssh">execute-with-ssh</h3>
            <div class="usage">[handler]</div>
            
            
            <div class="doc"><p>Execute cmds for the session. Also accepts an IP or hostname as address.</p>
</div>
          </div><div class="public">
            <h3 id="var-local-checked-script">local-checked-script</h3>
            <div class="usage">[msg &amp; body]</div>
            
            
            <div class="doc"><p>Run a script on the local machine, setting up stevedore to produce the
correct target specific code.  The return code is checked.</p>
</div>
          </div><div class="public">
            <h3 id="var-local-cmds">local-cmds</h3>
            <div class="usage">[commands]</div>
            
            
            <div class="doc"><p>Run local cmds on a target.</p>
</div>
          </div><div class="public">
            <h3 id="var-local-script">local-script</h3>
            <div class="usage">[&amp; body]</div>
            
            
            <div class="doc"><p>Run a script on the local machine, setting up stevedore to produce the
correct target specific code</p>
</div>
          </div><div class="public">
            <h3 id="var-local-script-expand">local-script-expand</h3>
            <div class="usage">[expr]</div>
            
            
            <div class="doc"><p>Expand a script expression.</p>
</div>
          </div><div class="public">
            <h3 id="var-output-poll-period">output-poll-period</h3>
            
            
            
            <div class="doc"><p>Specifies the polling period for retrieving ssh command output.
Defaults to 1000ms.</p>
</div>
          </div><div class="public">
            <h3 id="var-remote-exec">remote-exec</h3>
            <div class="usage">[server command user]</div>
            
            
            <div class="doc"><p>Run an ssh exec command on a server.</p>
</div>
          </div><div class="public">
            <h3 id="var-remote-sudo">remote-sudo</h3>
            <div class="usage">[server command user {:keys [pty agent-forwarding], :as options}]</div>
            
            
            <div class="doc"><p>Run a sudo command on a server.</p>
</div>
          </div><div class="public">
            <h3 id="var-remote-sudo-cmd">remote-sudo-cmd</h3>
            <div class="usage">[server ssh-session sftp-channel user tmpfile command {:keys [pty agent-forwarding], :or {pty true}, :as options}]</div>
            
            
            <div class="doc"><p>Execute remote command.
Copies <code>command</code> to <code>tmpfile</code> on the remote node using the <code>sftp-channel</code>
and executes the <code>tmpfile</code> as the specified <code>user</code>.</p>
</div>
          </div><div class="public">
            <h3 id="var-sh-script">sh-script</h3>
            <div class="usage">[command]</div>
            
            
            <div class="doc"><p>Run a script on local machine.</p>
</div>
          </div><div class="public">
            <h3 id="var-ssh-bash-on-target">ssh-bash-on-target</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Execute a bash action on the target via ssh.</p>
</div>
          </div><div class="public">
            <h3 id="var-ssh-from-local">ssh-from-local</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Transfer a file from the origin machine to the target via ssh.</p>
</div>
          </div><div class="public">
            <h3 id="var-ssh-output-buffer-size">ssh-output-buffer-size</h3>
            
            
            
            <div class="doc"><p>Specifies the buffer size used to read the ssh output stream.
Defaults to 10K, to match clj-ssh.ssh/<em>piped-stream-buffer-size</em></p>
</div>
          </div><div class="public">
            <h3 id="var-ssh-to-local">ssh-to-local</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Transfer a file from the origin machine to the target via ssh.</p>
</div>
          </div><div class="public">
            <h3 id="var-ssh-user-credentials">ssh-user-credentials</h3>
            <div class="usage">[handler]</div>
            
            
            <div class="doc"><p>Middleware to user the session :user credentials for SSH authentication.</p>
</div>
          </div><div class="public">
            <h3 id="var-sudo-cmd-for">sudo-cmd-for</h3>
            <div class="usage">[user]</div>
            
            
            <div class="doc"><p>Construct a sudo command prefix for the specified user.</p>
</div>
          </div><div class="public">
            <h3 id="var-transfer-on-origin">transfer-on-origin</h3>
            <div class="usage">[session f]</div>
            
            
            <div class="doc"><p>Transfer files on origin by copying</p>
</div>
          </div><div class="public">
            <h3 id="var-verify-sh-return">verify-sh-return</h3>
            <div class="usage">[msg cmd result]</div>
            
            
            <div class="doc"><p>Verify the return code of a sh execution</p>
</div>
          </div><div class="public">
            <h3 id="var-with-ssh-tunnel">with-ssh-tunnel</h3>
            <div class="usage">[session tunnels &amp; body]</div>
            
            
            <div class="doc"><p>Execute the body with an ssh-tunnel available for the ports given in the
tunnels map. Automatically closes port forwards on completion.</p>

<p>Tunnels should be a map from local ports (integers) to either
  1) An integer remote port. Remote host is assumed to be "localhost".
  2) A vector of remote host and remote port. eg, ["yahoo.com" 80].</p>

<p>e.g.
     (with-ssh-tunnel session {2222 22}
        ;; do something on local port 2222
        session)</p>
</div>
          </div>
        </div>
      </div>
    </article>
  </body>

</html>